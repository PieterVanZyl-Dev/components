/*
 Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.
 SPDX-License-Identifier: Apache-2.0
*/

@use '../../internal/hooks/focus-visible' as focus-visible;
@use '../../internal/styles/tokens' as awsui;
@use '../../internal/styles' as styles;

$resize-handle-width: awsui.$space-l;
$active-separator-width: 2px;

.header-cell {
  position: relative;
  text-align: left;
  box-sizing: border-box;
  border-bottom: awsui.$border-divider-section-width solid awsui.$color-border-divider-default;
  background: awsui.$color-background-table-header;
  color: awsui.$color-text-column-header;
  font-weight: awsui.$font-heading-s-weight;
  @include styles.font-smoothing;
  padding: awsui.$space-scaled-xxs awsui.$space-scaled-xs;
  &-sticky {
    border-bottom: awsui.$border-table-sticky-width solid awsui.$color-border-divider-default;
  }
  &-freeze {
    @include styles.with-motion {
      transition-property: padding;
      transition-duration: awsui.$motion-duration-transition-show-paced;
      transition-timing-function: awsui.$motion-easing-sticky;
    }
    position: sticky;
    background: awsui.$color-background-table-header;
    z-index: 11;
    &-last-start {
      box-shadow: awsui.$shadow-sticky-column-start;
      clip-path: inset(0px -24px 0px 0px);
      &:not(.header-cell-resizable):before {
        display: none;
      }
    }
    &-last-end {
      box-shadow: awsui.$shadow-sticky-column-end;
      clip-path: inset(0 0 0 -24px);
      &:not(.header-cell-resizable):before {
        display: none;
      }
    }
    &-stuck-right {
      &:before {
        content: '';
        position: absolute;
        bottom: 25%;
        height: 50%;
        border-left: awsui.$border-divider-section-width solid awsui.$color-border-divider-interactive-default;
        box-sizing: border-box;
        left: 0;
      }
    }
    &.header-cell-resizable:before {
      border-left-color: awsui.$color-border-divider-interactive-default;
    }
  }
  &-stuck:not(.header-cell-variant-full-page) {
    border-bottom-color: transparent;
  }
  &-variant-full-page.header-cell-hidden {
    border-bottom-color: transparent;
  }
  &:last-child,
  &.header-cell-sortable {
    padding-right: awsui.$space-xs;
  }

  &:before {
    content: '';
    position: absolute;
    right: 0;
    bottom: 25%;
    height: 50%;
    border-left: awsui.$border-divider-section-width solid awsui.$color-border-divider-default;
    box-sizing: border-box;
  }

  &-resizable {
    &:before {
      border-left-color: awsui.$color-border-divider-interactive-default;
    }
    &:not(.is-visual-refresh):not(.header-cell-freeze-stuck-right):last-child::before {
      border-left-color: transparent;
    }
  }
  &:not(.header-cell-resizable):before {
    border-left-color: awsui.$color-border-divider-default;
  }
}

.sorting-icon {
  position: absolute;
  top: awsui.$space-scaled-xxs;
  right: awsui.$space-xxs;
  color: awsui.$color-text-column-sorting-icon;
}

.edit-icon {
  margin-left: awsui.$space-xxs;
  margin-top: awsui.$space-scaled-xxs;
  color: inherit;
}

.header-cell-content {
  position: relative;

  padding: awsui.$space-scaled-xxs awsui.$space-s;
  .header-cell-sortable > & {
    padding-right: calc(#{awsui.$space-xl} + #{awsui.$space-xxs});
  }
  &:focus {
    outline: none;
    text-decoration: none;
  }

  @include focus-visible.when-visible {
    @include styles.focus-highlight(awsui.$space-table-header-focus-outline-gutter);
  }

  &.header-cell-fake-focus {
    @include styles.focus-highlight(awsui.$space-table-header-focus-outline-gutter);
  }

  .header-cell-disabled.header-cell-sorted > & {
    & > .sorting-icon {
      color: awsui.$color-text-interactive-disabled;
    }
  }
}

.header-cell-sortable:not(.header-cell-disabled) {
  & > .header-cell-content {
    cursor: pointer;
  }
  & > .header-cell-content:hover,
  &.header-cell-sorted > .header-cell-content {
    color: awsui.$color-text-interactive-active;
    & > .sorting-icon {
      color: awsui.$color-text-interactive-active;
    }
  }
}

.header-cell-text {
  &:not(.header-cell-text-wrap) {
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
  }
}

.header-cell-ascending,
.header-cell-descending {
  /* used in test-utils */
}

/*
In Visual Refresh the first cell in the header should align
with the left edge of the table as closely as possible. If the
last header cell is sortable the sort icon should align with the
settings icon in the pagination slot.
*/
.header-cell:not(.is-visual-refresh) {
  &:first-child {
    padding-left: awsui.$space-xs;
  }
}

.header-cell.is-visual-refresh {
  &:first-child:not(.has-striped-rows) {
    padding-left: awsui.$space-xxxs;
  }

  /*
  Striped rows requires additional left padding because the
  shaded background makes the child content appear too close
  to the table edge.
  */
  &:first-child.has-striped-rows {
    padding-left: awsui.$space-xxs;
  }

  &:first-child > .header-cell-content {
    padding-left: 0;
  }

  &:last-child.header-cell-sortable {
    padding-right: awsui.$space-xxxs;
  }
}
